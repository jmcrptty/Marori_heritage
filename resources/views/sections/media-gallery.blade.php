<!-- Media Gallery Section with Slider -->
<section id="galeri" class="media-gallery-section-slider">
    <div class="media-gallery-slider-bg">
        <div class="container-fluid px-4">
            <!-- Header -->
            <div class="media-gallery-header">
                <span class="media-gallery-label">GALERI MEDIA</span>
                <h2 class="media-gallery-main-title">Jelajahi Kehidupan Marori</h2>
                <p class="media-gallery-subtitle">
                    Saksikan kehidupan dan budaya Suku Marori melalui dokumentasi visual yang menakjubkan
                </p>
            </div>

            <!-- Video Slider -->
            <div class="media-gallery-slider-wrapper">
                <div class="media-gallery-slider-container" id="mediaGallerySlider">
                    <!-- Video 1 -->
                    <div class="media-slide">
                        <div class="media-card">
                            <div class="media-video-wrapper">
                                <iframe
                                    src="https://www.youtube.com/embed/KpCwki0hWDQ"
                                    title="Suku Marori Wasur - Dokumenter"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen>
                                </iframe>
                                <div class="media-overlay">
                                    <div class="media-content">
                                        <span class="media-category">DOKUMENTER</span>
                                        <h3 class="media-title">Kehidupan Suku Marori di Taman Nasional Wasur</h3>
                                        <p class="media-description">Dokumenter tentang kehidupan sehari-hari masyarakat Suku Marori dan bagaimana mereka menjaga kelestarian hutan Wasur.</p>
                                        <a href="https://www.youtube.com/watch?v=KpCwki0hWDQ" target="_blank" class="media-btn">
                                            <i class="bi bi-play-circle"></i> WATCH
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video 2 -->
                    <div class="media-slide">
                        <div class="media-card">
                            <div class="media-video-wrapper">
                                <iframe
                                    src="https://www.youtube.com/embed/dQw4w9WgXcQ"
                                    title="Budaya Marori"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen>
                                </iframe>
                                <div class="media-overlay">
                                    <div class="media-content">
                                        <span class="media-category">BUDAYA</span>
                                        <h3 class="media-title">Tarian dan Ritual Tradisional Marori</h3>
                                        <p class="media-description">Saksikan tarian perang dan ritual adat yang masih dilestarikan oleh masyarakat Marori hingga saat ini.</p>
                                        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank" class="media-btn">
                                            <i class="bi bi-play-circle"></i> WATCH
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video 3 -->
                    <div class="media-slide">
                        <div class="media-card">
                            <div class="media-video-wrapper">
                                <iframe
                                    src="https://www.youtube.com/embed/jNQXAC9IVRw"
                                    title="Kerajinan Marori"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen>
                                </iframe>
                                <div class="media-overlay">
                                    <div class="media-content">
                                        <span class="media-category">KERAJINAN</span>
                                        <h3 class="media-title">Proses Pembuatan Noken Tradisional</h3>
                                        <p class="media-description">Ikuti proses pembuatan noken, tas tradisional khas Papua yang dibuat dengan teknik turun-temurun.</p>
                                        <a href="https://www.youtube.com/watch?v=jNQXAC9IVRw" target="_blank" class="media-btn">
                                            <i class="bi bi-play-circle"></i> WATCH
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video 4 -->
                    <div class="media-slide">
                        <div class="media-card">
                            <div class="media-video-wrapper">
                                <iframe
                                    src="https://www.youtube.com/embed/9bZkp7q19f0"
                                    title="Alam Wasur"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen>
                                </iframe>
                                <div class="media-overlay">
                                    <div class="media-content">
                                        <span class="media-category">ALAM</span>
                                        <h3 class="media-title">Keindahan Taman Nasional Wasur</h3>
                                        <p class="media-description">Jelajahi keindahan savana, hutan, dan satwa liar di Taman Nasional Wasur, habitat asli Suku Marori.</p>
                                        <a href="https://www.youtube.com/watch?v=9bZkp7q19f0" target="_blank" class="media-btn">
                                            <i class="bi bi-play-circle"></i> WATCH
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <button class="media-nav-btn media-prev-btn" id="mediaPrevBtn">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <button class="media-nav-btn media-next-btn" id="mediaNextBtn">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div> <!-- End media-gallery-slider-wrapper -->

            <!-- Photo Gallery Grid -->
            <div class="photo-gallery-section">
                <div class="photo-gallery-header">
                    <span class="photo-gallery-label">GALERI FOTO</span>
                    <h2 class="photo-gallery-title">Momen Berharga Marori</h2>
                    <p class="photo-gallery-subtitle">
                        Koleksi foto-foto memukau yang mengabadikan kehidupan, budaya, dan keindahan alam Suku Marori
                    </p>
                </div>

                <div class="photo-grid">
                    <!-- Photo 1 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1551918120-9739cb430c6d?w=800&q=80" alt="Budaya Marori" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">BUDAYA</span>
                                    <h4 class="photo-title">Tarian Tradisional</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 2 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&q=80" alt="Alam Wasur" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">ALAM</span>
                                    <h4 class="photo-title">Savana Wasur</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 3 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1566404394190-cda8c6209208?w=800&q=80" alt="Kerajinan Marori" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">KERAJINAN</span>
                                    <h4 class="photo-title">Noken Papua</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 4 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=800&q=80" alt="Pemandangan" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">PEMANDANGAN</span>
                                    <h4 class="photo-title">Matahari Terbenam</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 5 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?w=800&q=80" alt="Rumah Adat" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">ARSITEKTUR</span>
                                    <h4 class="photo-title">Rumah Adat Marori</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 6 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1504198458649-3128b932f49e?w=800&q=80" alt="Ritual Adat" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">UPACARA</span>
                                    <h4 class="photo-title">Ritual Adat</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 7 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80" alt="Hutan Papua" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">ALAM</span>
                                    <h4 class="photo-title">Hutan Tropis Papua</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 8 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1445262102387-5fbb30a5e59d?w=800&q=80" alt="Senjata Tradisional" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">TRADISI</span>
                                    <h4 class="photo-title">Senjata Tradisional</h4>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo 9 -->
                    <div class="photo-item">
                        <div class="photo-card">
                            <img src="https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=800&q=80" alt="Kearifan Lokal" loading="lazy">
                            <div class="photo-overlay">
                                <div class="photo-content">
                                    <span class="photo-category">KOMUNITAS</span>
                                    <h4 class="photo-title">Kehidupan Bersama</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- End photo-gallery-section -->

        </div> <!-- End container-fluid -->
    </div> <!-- End media-gallery-slider-bg -->
</section>

<style>
    /* Media Gallery Slider Section */
    .media-gallery-section-slider {
        padding: 0;
        margin: 0;
        position: relative;
        overflow: hidden;
        min-height: 200vh;
        display: flex;
        align-items: flex-start;
    }

    .media-gallery-slider-bg {
        background: #FFFFFF;
        width: 100%;
        min-height: 200vh;
        padding: 80px 0 80px;
        position: relative;
    }

    .media-gallery-slider-bg .container-fluid {
        position: relative;
        z-index: 2;
        width: 100%;
        max-width: 100%;
        padding-left: 15px;
        padding-right: 15px;
    }

    /* Header */
    .media-gallery-header {
        text-align: center;
        margin-bottom: 40px;
        padding-top: 60px;
        position: relative;
        z-index: 2;
    }

    .media-gallery-label {
        display: inline-block;
        font-size: 0.7rem;
        font-weight: 700;
        letter-spacing: 3px;
        color: #2C4A3E;
        text-transform: uppercase;
        margin-bottom: 12px;
        background: rgba(44, 74, 62, 0.1);
        padding: 6px 16px;
        border-radius: 20px;
    }

    .media-gallery-main-title {
        font-family: 'Playfair Display', serif;
        font-size: 2.5rem;
        color: #2C4A3E;
        margin-bottom: 12px;
        font-weight: 700;
        line-height: 1.2;
        letter-spacing: -1px;
    }

    .media-gallery-subtitle {
        color: #5D4037;
        font-size: 1rem;
        line-height: 1.5;
        max-width: 650px;
        margin: 0 auto;
    }

    /* Slider Wrapper */
    .media-gallery-slider-wrapper {
        position: relative;
        overflow: hidden;
        margin: 0 auto 60px;
        max-width: 100%;
        width: 100%;
        min-height: 70vh;
        display: flex;
        align-items: center;
    }

    .media-gallery-slider-container {
        display: flex;
        gap: 20px;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        width: max-content;
        position: relative;
        z-index: 1;
        padding: 40px 0;
    }

    /* Media Slide - Each takes ~80% of viewport width */
    .media-slide {
        flex: 0 0 auto;
        min-width: 200px;
        transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        opacity: 0.6;
        filter: brightness(0.7);
        z-index: 1;
        pointer-events: none;
    }

    /* Active/Center slide */
    .media-slide.active {
        opacity: 1;
        filter: brightness(1);
        z-index: 10;
        pointer-events: all;
    }

    /* Media Card */
    .media-card {
        background: white;
        border-radius: 24px;
        overflow: hidden;
        height: 100%;
        display: flex;
        flex-direction: column;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    }

    .media-video-wrapper {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
        height: 0;
        overflow: hidden;
        background: #000;
        border-radius: 24px;
    }

    .media-video-wrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 24px;
    }

    /* Media Overlay */
    .media-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.6) 50%, transparent 100%);
        padding: 40px 30px 30px;
        opacity: 0;
        transition: opacity 0.4s ease;
        pointer-events: none;
    }

    .media-card:hover .media-overlay {
        opacity: 1;
        pointer-events: all;
    }

    .media-content {
        position: relative;
        z-index: 3;
    }

    .media-category {
        display: inline-block;
        font-size: 0.7rem;
        font-weight: 700;
        letter-spacing: 2px;
        color: #7FB685;
        text-transform: uppercase;
        margin-bottom: 10px;
        background: rgba(127, 182, 133, 0.2);
        padding: 4px 12px;
        border-radius: 12px;
    }

    .media-title {
        font-family: 'Playfair Display', serif;
        font-size: 1.8rem;
        color: white;
        margin-bottom: 12px;
        font-weight: 700;
        line-height: 1.3;
    }

    .media-description {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1rem;
        line-height: 1.6;
        margin-bottom: 20px;
    }

    .media-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 12px 28px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50px;
        color: white;
        font-size: 0.9rem;
        font-weight: 700;
        letter-spacing: 1px;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .media-btn:hover {
        background: rgba(255, 255, 255, 0.25);
        border-color: rgba(255, 255, 255, 0.5);
        color: white;
        transform: translateY(-2px);
    }

    .media-btn i {
        font-size: 1.2rem;
    }

    /* Navigation Buttons */
    .media-nav-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: rgba(44, 74, 62, 0.1);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(44, 74, 62, 0.3);
        color: #2C4A3E;
        font-size: 1.8rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 50;
        opacity: 1;
        visibility: visible;
    }

    .media-nav-btn:hover {
        background: rgba(44, 74, 62, 0.2);
        border-color: rgba(44, 74, 62, 0.5);
        transform: translateY(-50%) scale(1.1);
    }

    .media-nav-btn:active {
        transform: translateY(-50%) scale(0.95);
    }

    .media-prev-btn {
        left: 20px;
    }

    .media-next-btn {
        right: 20px;
    }

    /* Photo Gallery Section */
    .photo-gallery-section {
        margin-top: 80px;
        padding: 0 15px 60px;
        position: relative;
        z-index: 2;
    }

    .photo-gallery-header {
        text-align: center;
        margin-bottom: 60px;
    }

    .photo-gallery-label {
        display: inline-block;
        font-size: 0.7rem;
        font-weight: 700;
        letter-spacing: 3px;
        color: #2C4A3E;
        text-transform: uppercase;
        margin-bottom: 12px;
        background: rgba(44, 74, 62, 0.1);
        padding: 6px 16px;
        border-radius: 20px;
    }

    .photo-gallery-title {
        font-family: 'Playfair Display', serif;
        font-size: 2.5rem;
        color: #2C4A3E;
        margin-bottom: 12px;
        font-weight: 700;
        line-height: 1.2;
        letter-spacing: -1px;
    }

    .photo-gallery-subtitle {
        color: #5D4037;
        font-size: 1rem;
        line-height: 1.5;
        max-width: 650px;
        margin: 0 auto;
    }

    /* Photo Grid - 3 columns */
    .photo-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 30px;
        max-width: 1400px;
        margin: 0 auto;
    }

    .photo-item {
        position: relative;
        overflow: hidden;
        border-radius: 20px;
        transition: transform 0.4s ease;
    }

    .photo-item:hover {
        transform: translateY(-8px);
    }

    .photo-card {
        position: relative;
        overflow: hidden;
        border-radius: 20px;
        background: #000;
        aspect-ratio: 4 / 5;
    }

    .photo-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.6s ease, filter 0.4s ease;
    }

    .photo-card:hover img {
        transform: scale(1.1);
        filter: brightness(0.7);
    }

    /* Photo Overlay */
    .photo-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.5) 60%, transparent 100%);
        padding: 30px 25px 25px;
        transform: translateY(100%);
        transition: transform 0.4s ease;
    }

    .photo-card:hover .photo-overlay {
        transform: translateY(0);
    }

    .photo-content {
        position: relative;
        z-index: 3;
    }

    .photo-category {
        display: inline-block;
        font-size: 0.65rem;
        font-weight: 700;
        letter-spacing: 2px;
        color: #7FB685;
        text-transform: uppercase;
        margin-bottom: 8px;
        background: rgba(127, 182, 133, 0.2);
        padding: 4px 12px;
        border-radius: 12px;
    }

    .photo-title {
        font-family: 'Playfair Display', serif;
        font-size: 1.3rem;
        color: white;
        margin: 0;
        font-weight: 700;
        line-height: 1.3;
    }

    /* Responsive */
    @media (max-width: 1400px) {
        .media-gallery-slider-wrapper {
            max-width: 100%;
            width: 100%;
        }
    }

    @media (max-width: 1200px) {
        .media-gallery-main-title {
            font-size: 2rem;
        }

        .media-gallery-slider-wrapper {
            max-width: 100%;
            width: 100%;
        }
    }

    @media (max-width: 768px) {
        .media-gallery-section-slider {
            min-height: auto;
        }

        .media-gallery-slider-bg {
            min-height: auto;
            padding: 60px 0;
        }

        .media-gallery-slider-wrapper {
            max-width: 100%;
            width: 100%;
            min-height: 60vh;
            margin-bottom: 40px;
        }

        .media-gallery-slider-container {
            gap: 15px;
            padding: 30px 0;
        }

        .media-nav-btn {
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
        }

        .media-prev-btn {
            left: 15px;
        }

        .media-next-btn {
            right: 15px;
        }

        .media-gallery-header {
            padding-top: 40px;
            margin-bottom: 30px;
        }

        .media-gallery-main-title {
            font-size: 1.8rem;
        }

        .media-title {
            font-size: 1.4rem;
        }

        .media-description {
            font-size: 0.9rem;
        }

        .media-overlay {
            padding: 30px 20px 20px;
        }

        /* Photo Gallery Responsive - Tablet */
        .photo-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .photo-gallery-title {
            font-size: 2rem;
        }

        .photo-gallery-section {
            margin-top: 60px;
            padding: 0 15px 40px;
        }

        .photo-title {
            font-size: 1.2rem;
        }
    }

    @media (max-width: 576px) {
        .media-gallery-section-slider {
            min-height: auto;
        }

        .media-gallery-slider-bg {
            min-height: auto;
            padding: 40px 0;
        }

        .media-gallery-slider-wrapper {
            max-width: 100%;
            width: 100%;
            min-height: 50vh;
            margin-bottom: 30px;
        }

        .media-gallery-slider-container {
            gap: 12px;
            padding: 25px 0;
        }

        .media-nav-btn {
            width: 45px;
            height: 45px;
            font-size: 1.3rem;
        }

        .media-prev-btn {
            left: 10px;
        }

        .media-next-btn {
            right: 10px;
        }

        .media-gallery-header {
            padding-top: 30px;
            margin-bottom: 25px;
        }

        .media-title {
            font-size: 1.2rem;
        }

        .media-description {
            font-size: 0.85rem;
            margin-bottom: 15px;
        }

        .media-btn {
            padding: 10px 20px;
            font-size: 0.85rem;
        }

        /* Photo Gallery Responsive - Mobile */
        .photo-grid {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .photo-gallery-title {
            font-size: 1.8rem;
        }

        .photo-gallery-section {
            margin-top: 40px;
            padding: 0 15px 30px;
        }

        .photo-gallery-header {
            margin-bottom: 30px;
        }

        .photo-title {
            font-size: 1.1rem;
        }

        .photo-overlay {
            padding: 25px 20px 20px;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const slider = document.getElementById('mediaGallerySlider');
        const prevBtn = document.getElementById('mediaPrevBtn');
        const nextBtn = document.getElementById('mediaNextBtn');
        const slides = document.querySelectorAll('.media-slide');

        let currentIndex = 0;

        // Debug
        console.log('Media Gallery Slider initialized');
        console.log('Total slides:', slides.length);

        // Set slide widths dynamically
        function setSlideWidths() {
            const viewportWidth = window.innerWidth;
            // Responsive slide width percentage
            let widthPercentage = 0.75; // Desktop: 75% of viewport

            if (viewportWidth <= 576) {
                widthPercentage = 0.88; // Mobile: 88%
            } else if (viewportWidth <= 768) {
                widthPercentage = 0.82; // Tablet: 82%
            } else if (viewportWidth <= 1200) {
                widthPercentage = 0.78; // Small desktop: 78%
            }

            const slideWidth = viewportWidth * widthPercentage;

            console.log('Setting media slide widths:', {
                viewportWidth: viewportWidth,
                widthPercentage: widthPercentage,
                slideWidth: slideWidth
            });

            slides.forEach(slide => {
                slide.style.width = `${slideWidth}px`;
            });
        }

        // Update active slide for 3D effect
        function updateActiveSlide() {
            slides.forEach((slide, index) => {
                if (index === currentIndex) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });
        }

        // Update slider position (with clones)
        function updateSlider(instant = false) {
            const allSlides = document.querySelectorAll('.media-slide');
            if (!allSlides[0]) {
                console.error('No media slides found!');
                return;
            }
            const viewportWidth = window.innerWidth;
            const slideWidth = allSlides[0].offsetWidth;
            const totalSlides = slides.length;

            // Responsive gap
            let gap = 20; // Desktop default
            if (viewportWidth <= 576) {
                gap = 12;
            } else if (viewportWidth <= 768) {
                gap = 15;
            }

            // Account for clone at the beginning (+1 offset)
            let displayIndex = currentIndex + 1;

            // Center the current slide in viewport
            const centerOffset = (viewportWidth - slideWidth) / 2;
            // Then subtract the position of current slide
            let offset = centerOffset - (displayIndex * (slideWidth + gap));

            console.log('Update media slider:', {
                currentIndex: currentIndex,
                displayIndex: displayIndex,
                viewportWidth: viewportWidth,
                slideWidth: slideWidth,
                centerOffset: centerOffset,
                gap: gap,
                finalOffset: offset,
                instant: instant
            });

            // Apply transition or instant
            if (instant) {
                slider.style.transition = 'none';
                slider.style.transform = `translateX(${offset}px)`;
                // Force reflow
                slider.offsetHeight;
                slider.style.transition = 'transform 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
            } else {
                slider.style.transform = `translateX(${offset}px)`;
            }

            updateActiveSlide();
        }

        // Next slide - seamless infinite loop with clones
        function nextSlide() {
            const totalSlides = slides.length;
            currentIndex++;

            // Animate to next position
            updateSlider(false);

            // If we went past the last real slide, we're on clone
            // Wait for transition, then jump to real first slide
            if (currentIndex >= totalSlides) {
                setTimeout(() => {
                    currentIndex = 0;
                    updateSlider(true); // Instant jump without transition
                }, 800); // Match transition duration
            }

            console.log('Next media slide:', {
                currentIndex: currentIndex,
                totalSlides: totalSlides
            });
        }

        // Previous slide - seamless infinite loop with clones
        function prevSlide() {
            const totalSlides = slides.length;
            currentIndex--;

            // Animate to prev position
            updateSlider(false);

            // If we went before first real slide, we're on clone
            // Wait for transition, then jump to real last slide
            if (currentIndex < 0) {
                setTimeout(() => {
                    currentIndex = totalSlides - 1;
                    updateSlider(true); // Instant jump without transition
                }, 800); // Match transition duration
            }

            console.log('Prev media slide:', {
                currentIndex: currentIndex,
                totalSlides: totalSlides
            });
        }

        // Event listeners
        nextBtn.addEventListener('click', nextSlide);
        prevBtn.addEventListener('click', prevSlide);

        // Handle window resize
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                // Don't reset index, just recalculate widths
                const allSlides = document.querySelectorAll('.media-slide');
                const viewportWidth = window.innerWidth;
                let widthPercentage = 0.75;
                if (viewportWidth <= 576) widthPercentage = 0.88;
                else if (viewportWidth <= 768) widthPercentage = 0.82;
                else if (viewportWidth <= 1200) widthPercentage = 0.78;

                const slideWidth = viewportWidth * widthPercentage;
                allSlides.forEach(slide => {
                    slide.style.width = `${slideWidth}px`;
                });

                updateSlider(true);
            }, 250);
        });

        // Clone slides for seamless infinite loop
        function cloneSlidesForLoop() {
            const totalSlides = slides.length;

            // Clone last slide and prepend
            const lastSlideClone = slides[totalSlides - 1].cloneNode(true);
            lastSlideClone.classList.add('clone');
            lastSlideClone.classList.remove('active');
            slider.insertBefore(lastSlideClone, slides[0]);

            // Clone first slide and append
            const firstSlideClone = slides[0].cloneNode(true);
            firstSlideClone.classList.add('clone');
            firstSlideClone.classList.remove('active');
            slider.appendChild(firstSlideClone);

            console.log('Cloned slides for seamless loop');
        }

        // Initialize
        cloneSlidesForLoop();

        // Re-query slides after cloning
        const allSlides = document.querySelectorAll('.media-slide');
        console.log('Total slides with clones:', allSlides.length);

        // Set widths for all slides including clones
        const viewportWidth = window.innerWidth;
        let widthPercentage = 0.75;
        if (viewportWidth <= 576) widthPercentage = 0.88;
        else if (viewportWidth <= 768) widthPercentage = 0.82;
        else if (viewportWidth <= 1200) widthPercentage = 0.78;

        const slideWidth = viewportWidth * widthPercentage;
        allSlides.forEach(slide => {
            slide.style.width = `${slideWidth}px`;
        });

        // Start at index 1 (first real slide, after clone)
        currentIndex = 0;
        updateSlider();

        // Set first slide as active on load
        if (slides.length > 0) {
            slides[0].classList.add('active');
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                prevSlide();
            } else if (e.key === 'ArrowRight') {
                nextSlide();
            }
        });
    });
</script>
